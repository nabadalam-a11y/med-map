<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–≠–≤–∞–∫—É–∞—Ü–∏—è ‚Äî –±—ã—Å—Ç—Ä–∞—è –æ—Ü–µ–Ω–∫–∞</title>
  <style>
    :root{
      --green:#2e7d32;
      --green2:#1b5e20;
      --bg:#f6f7f9;
      --card:#ffffff;
      --text:#111;
      --muted:#666;
      --border:#e3e6ea;
      --shadow:0 2px 10px rgba(0,0,0,.06);
      --red:#d32f2f;
      --orange:#f57c00;
      --yellow:#f9a825;
      --blue:#1976d2;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background:var(--bg);
      color:var(--text);
    }
    header{
      background:var(--green2);
      color:#fff;
      padding:14px 12px;
      text-align:center;
      font-weight:800;
      letter-spacing:.4px;
      font-size:18px;
      position:sticky;
      top:0;
      z-index:50;
    }
    .wrap{max-width:980px;margin:0 auto;padding:12px;}
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:14px;
      box-shadow:var(--shadow);
      padding:12px;
      margin:10px 0;
    }

    .row{display:flex;gap:10px;flex-wrap:wrap}
    .col{flex:1;min-width:190px}

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#fff;
      font-size:13px;
      color:var(--muted);
    }
    .dot{
      width:12px;height:12px;border-radius:50%;
      background:#bbb;
      border:2px solid rgba(0,0,0,.08);
    }
    .dot.red{background:var(--red)}
    .dot.orange{background:var(--orange)}
    .dot.yellow{background:var(--yellow)}
    .dot.green{background:var(--green)}
    .dot.blue{background:var(--blue)}

    .item{
      display:flex;
      gap:12px;
      align-items:flex-start;
      padding:12px 10px;
      border:1px solid var(--border);
      border-radius:14px;
      background:#fff;
      margin:10px 0;
    }
    .item:active{opacity:.92}
    input[type="checkbox"]{
      width:26px;height:26px;margin-top:2px;
      accent-color: var(--green2);
      flex:0 0 auto;
    }
    .itTitle{
      font-weight:800;
      font-size:16px;
      line-height:1.25;
    }
    .itDesc{
      margin-top:4px;
      font-size:13px;
      color:var(--muted);
      line-height:1.3;
    }
    .meta{
      margin-top:6px;
      font-size:12px;
      color:#8a8a8a;
    }
    .tag{
      display:inline-block;
      font-size:12px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#fafafa;
      margin-right:6px;
    }
    .tag.crit{border-color:#ffb3b3;background:#fff0f0;color:#9b1b1b}
    .tag.score{border-color:#cfe6d1;background:#eff9ef;color:#1f6b23}
    .tag.stab{border-color:#cfe6ff;background:#eef6ff;color:#0c4aa6}
    details summary{
      cursor:pointer;
      font-weight:800;
      font-size:15px;
      list-style:none;
      user-select:none;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    details summary::-webkit-details-marker{display:none}
    .summaryRight{display:flex;align-items:center;gap:10px;color:var(--muted);font-size:13px;font-weight:600}

    .resultBox{
      border-radius:14px;
      border:2px solid rgba(0,0,0,.08);
      background:#f3f6f4;
      padding:12px;
    }
    .resultBox.red{background:#fff1f1;border-color:rgba(211,47,47,.35)}
    .resultBox.orange{background:#fff6ed;border-color:rgba(245,124,0,.35)}
    .resultBox.yellow{background:#fffbe8;border-color:rgba(249,168,37,.35)}
    .resultBox.green{background:#edf8ee;border-color:rgba(46,125,50,.35)}
    .resTitle{
      font-weight:900;
      font-size:18px;
      margin:0 0 6px;
      letter-spacing:.2px;
    }
    .resSmall{color:var(--muted);font-size:13px;line-height:1.35}
    .list{
      margin:8px 0 0;
      padding-left:18px;
      font-size:14px;
      line-height:1.35;
    }
    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size:12px;
      padding:2px 6px;
      border:1px solid var(--border);
      border-bottom-width:2px;
      border-radius:8px;
      background:#fff;
    }

    .btnRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    button{
      border:none;
      border-radius:12px;
      padding:14px 14px;
      font-size:16px;
      font-weight:800;
      cursor:pointer;
      touch-action:manipulation;
    }
    .btnPrimary{
      background:var(--green2);
      color:#fff;
      flex:1;
    }
    .btnPrimary:active{opacity:.9}
    .btnGhost{
      background:#fff;
      border:1px solid var(--border);
      color:#111;
      flex:1;
    }
    .btnGhost:active{opacity:.9}
    .toast{
      position:fixed;left:50%;bottom:14px;transform:translateX(-50%);
      background:rgba(0,0,0,.85);color:#fff;
      padding:10px 12px;border-radius:12px;
      display:none;max-width:92%;z-index:9999;
      font-size:14px;white-space:pre-wrap;
    }
    .footHint{font-size:12px;color:var(--muted);line-height:1.35}
  </style>
</head>
<body>
<header>–≠–í–ê–ö–£–ê–¶–ò–Ø ‚Äî –ë–´–°–¢–†–ê–Ø –û–¶–ï–ù–ö–ê</header>

<div class="wrap">

  <!-- –ù–ê–°–¢–†–û–ô–ö–ò/–ü–û–î–°–ö–ê–ó–ö–ò -->
  <div class="card">
    <div class="row">
      <div class="col">
        <div class="pill"><span class="dot red"></span> –°–ï–ô–ß–ê–° ‚Äî –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è —ç–≤–∞–∫—É–∞—Ü–∏—è</div>
      </div>
      <div class="col">
        <div class="pill"><span class="dot orange"></span> –°–ö–û–†–û ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è —ç–≤–∞–∫—É–∞—Ü–∏—è</div>
      </div>
      <div class="col">
        <div class="pill"><span class="dot yellow"></span> –ü–õ–ê–ù–û–í–û ‚Äî –ø—Ä–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</div>
      </div>
      <div class="col">
        <div class="pill"><span class="dot green"></span> –ù–ê –ú–ï–°–¢–ï ‚Äî –Ω–∞–±–ª—é–¥–∞—Ç—å/–∫—É–ø–∏—Ä–æ–≤–∞—Ç—å</div>
      </div>
    </div>
    <div class="footHint" style="margin-top:10px">
      –õ–æ–≥–∏–∫–∞: –µ—Å–ª–∏ –æ—Ç–º–µ—á–µ–Ω –ª—é–±–æ–π <span class="tag crit">–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π</span> –ø—É–Ω–∫—Ç ‚Üí <b>–°–ï–ô–ß–ê–°</b>.
      –ò–Ω–∞—á–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è —Å—É–º–º–∞ <span class="tag score">–±–∞–ª–ª–æ–≤</span>.
      –ï—Å–ª–∏ –æ—Ç–º–µ—á–µ–Ω–æ —Ç–æ–ª—å–∫–æ <span class="tag stab">—Å—Ç–∞–±–∏–ª—å–Ω–æ</span> ‚Üí <b>–ù–ê –ú–ï–°–¢–ï</b>.
      –ö–æ–Ω—Ç—Ä–æ–ª—å/–ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∞ –∫–∞–∂–¥—ã–µ <span class="kbd" id="obsMins">15</span> –º–∏–Ω—É—Ç.
    </div>
  </div>

  <!-- –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ) -->
  <div class="card">
    <details open>
      <summary>
        <span>üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ ‚Äî –µ—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Ç—å –æ–¥–∏–Ω ‚Üí ¬´–°–ï–ô–ß–ê–°¬ª</span>
        <span class="summaryRight"><span id="critCount">0</span> –æ—Ç–º–µ—á–µ–Ω–æ</span>
      </summary>

      <div id="critList"></div>
    </details>
  </div>

  <!-- –ë–ê–õ–õ–¨–ù–´–ï -->
  <div class="card">
    <details open>
      <summary>
        <span>üü†/üü° –ë–∞–ª–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã ‚Äî —Å—á–∏—Ç–∞–µ–º —Å—É–º–º—É</span>
        <span class="summaryRight">–ë–∞–ª–ª—ã: <b id="scoreSum">0</b></span>
      </summary>

      <div id="scoreList"></div>
    </details>
  </div>

  <!-- –°–¢–ê–ë–ò–õ–¨–ù–û -->
  <div class="card">
    <details open>
      <summary>
        <span>üü¢ ¬´–°—Ç–∞–±–∏–ª—å–Ω–æ¬ª ‚Äî –¥–ª—è ¬´–Ω–∞–±–ª—é–¥–∞—Ç—å –Ω–∞ –º–µ—Å—Ç–µ¬ª</span>
        <span class="summaryRight"><span id="stabCount">0</span> –æ—Ç–º–µ—á–µ–Ω–æ</span>
      </summary>

      <div id="stabList"></div>
    </details>
  </div>

  <!-- –†–ï–ó–£–õ–¨–¢–ê–¢ -->
  <div class="card">
    <div class="row" style="align-items:center;gap:8px">
      <div class="pill"><span class="dot blue"></span> –û—Ç–º–µ—á–µ–Ω–æ: <b id="pickedCount">0</b></div>
      <div class="pill"><span class="dot red"></span> –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ: <b id="critBadge">–ù–ï–¢</b></div>
      <div class="pill"><span class="dot orange"></span> –ë–∞–ª–ª—ã: <b id="scoreBadge">0</b></div>
    </div>

    <div style="margin-top:10px" id="resultBox" class="resultBox">
      <div class="resTitle" id="resTitle">–ü–æ–∫–∞ –Ω–µ –æ—Ü–µ–Ω–µ–Ω–æ</div>
      <div class="resSmall" id="resWhy">–ü—Ä–∏—á–∏–Ω—ã: (–Ω–µ—Ç)</div>
      <ul class="list" id="resRec">
        <li>–û—Ç–º–µ—Ç—å –ø—É–Ω–∫—Ç—ã –≤—ã—à–µ ‚Äî –ø–æ—è–≤–∏—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.</li>
      </ul>
    </div>

    <div class="btnRow">
      <button class="btnPrimary" id="btnCopy">–ö–û–ü–ò–†–û–í–ê–¢–¨ –†–ï–ó–£–õ–¨–¢–ê–¢</button>
      <button class="btnGhost" id="btnReset">–°–ë–†–û–°</button>
    </div>
    <div class="footHint" style="margin-top:10px">
      –ü–æ–¥—Å–∫–∞–∑–∫–∞: –∫–æ–ø–∏—Ä—É–µ–º—ã–π —Ç–µ–∫—Å—Ç –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –≤—Å—Ç–∞–≤–∏—Ç—å –≤ —Ç–µ–ª–µ–≥—Ä–∞–º/—á–∞—Ç. –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–µ –Ω—É–∂–Ω–æ.
    </div>
  </div>

</div>

<div class="toast" id="toast"></div>

<script>
(function(){
  // ===== –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä–æ–≥–æ–≤ (–º–æ–∂–µ—à—å –ø–æ–¥–∫—Ä—É—Ç–∏—Ç—å –ø–æ–¥ –≤–∞—à—É —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å) =====
  const OBS_MINUTES = 15;              // –∏–Ω—Ç–µ—Ä–≤–∞–ª –Ω–∞–±–ª—é–¥–µ–Ω–∏—è
  const THRESH_SOON = 6;               // >= 6 –±–∞–ª–ª–æ–≤ ‚Üí "–°–ö–û–†–û"
  const THRESH_PLAN = 3;               // 3‚Äì5 –±–∞–ª–ª–æ–≤ ‚Üí "–ü–õ–ê–ù–û–í–û"
  // < 3 –±–∞–ª–ª–æ–≤ ‚Üí "–ù–ê –ú–ï–°–¢–ï" (–µ—Å–ª–∏ —Ö–æ—Ç—å —á—Ç–æ-—Ç–æ –æ—Ç–º–µ—á–µ–Ω–æ –∏ –Ω–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö)
  // –ï—Å–ª–∏ –æ—Ç–º–µ—á–µ–Ω–æ —Ç–æ–ª—å–∫–æ "—Å—Ç–∞–±–∏–ª—å–Ω–æ" ‚Üí "–ù–ê –ú–ï–°–¢–ï"

  // ===== –°–ø–∏—Å–∫–∏ –ø—É–Ω–∫—Ç–æ–≤ =====
  // –í–∞–∂–Ω–æ: —è –Ω–µ –¥–æ–±–∞–≤–ª—è—é "–ø—É–ª–µ–≤–æ–µ" (—Ç—ã –ø—Ä–æ—Å–∏–ª —É–±—Ä–∞—Ç—å). –¢—É—Ç —ç–≤–∞–∫-–æ—Ü–µ–Ω–∫–∞, –Ω–µ —Ç–∏–ø —Ä–∞–Ω–µ–Ω–∏—è.
  // CRIT: –ª—é–±–æ–µ ‚Üí –°–ï–ô–ß–ê–°
  const CRIT = [
    {
      id:"airway",
      title:"–ù–∞—Ä—É—à–µ–Ω–∏–µ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π / —É–≥—Ä–æ–∑—ã –ø—Ä–æ—Ö–æ–¥–∏–º–æ—Å—Ç–∏",
      desc:"—Å—Ç—Ä–∏–¥–æ—Ä, –Ω–∞—Ä–∞—Å—Ç–∞—é—â–∞—è –æ–¥—ã—à–∫–∞, –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≥–æ–≤–æ—Ä–∏—Ç—å, –≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è –∞—Å—Ñ–∏–∫—Å–∏—è",
      why:"–£–≥—Ä–æ–∑–∞ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π"
    },
    {
      id:"massBleed",
      title:"–¢—è–∂—ë–ª–æ–µ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ –ù–ï –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º",
      desc:"–∂–≥—É—Ç/—Ç–∞–º–ø–æ–Ω–∞–¥–∞ –Ω–µ –¥–µ—Ä–∂–∏—Ç, –∞–∫—Ç–∏–≤–Ω–æ–µ –∏—Å—Ç–µ—á–µ–Ω–∏–µ, –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–º–æ–∫–∞–µ—Ç –ø–æ–≤—è–∑–∫–∞",
      why:"–ù–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ"
    },
    {
      id:"shock",
      title:"–ü—Ä–∏–∑–Ω–∞–∫–∏ —à–æ–∫–∞ / —É—Ö—É–¥—à–µ–Ω–∏—è –ø–µ—Ä—Ñ—É–∑–∏–∏",
      desc:"—Ä–µ–∑–∫–∞—è —Å–ª–∞–±–æ—Å—Ç—å, —Ö–æ–ª–æ–¥–Ω–∞—è –ª–∏–ø–∫–∞—è –∫–æ–∂–∞, —Å–ø—É—Ç–∞–Ω–Ω–æ—Å—Ç—å, –≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è –±–ª–µ–¥–Ω–æ—Å—Ç—å, –ø–∞–¥–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –∏–∑–º–µ—Ä—è–µ—Ç–µ)",
      why:"–ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ —à–æ–∫"
    },
    {
      id:"chestSevere",
      title:"–†–∞–Ω–µ–Ω–∏–µ –≥—Ä—É–¥–∏ —Å –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ–π –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å—é",
      desc:"–Ω–∞—Ä–∞—Å—Ç–∞—é—â–µ–µ —É–¥—É—à—å–µ, —Ü–∏–∞–Ω–æ–∑, —É—Ö—É–¥—à–µ–Ω–∏–µ –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø–æ–º–æ—â—å",
      why:"–¢—è–∂—ë–ª–∞—è —Ç—Ä–∞–≤–º–∞ –≥—Ä—É–¥–∏"
    },
    {
      id:"abdSevere",
      title:"–ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ —Ç—è–∂—ë–ª–æ–µ –ø—Ä–æ–Ω–∏–∫–∞—é—â–µ–µ –∂–∏–≤–æ—Ç–∞/—Ç–∞–∑–∞ —Å —É—Ö—É–¥—à–µ–Ω–∏–µ–º",
      desc:"–Ω–∞—Ä–∞—Å—Ç–∞—é—â–∞—è –±–æ–ª—å/–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ, —É—Ö—É–¥—à–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è —Å–ª–∞–±–æ—Å—Ç—å",
      why:"–ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ —Ç—è–∂—ë–ª—É—é —Ç—Ä–∞–≤–º—É –∂–∏–≤–æ—Ç–∞/—Ç–∞–∑–∞"
    },
    {
      id:"headBad",
      title:"–¢—è–∂—ë–ª–∞—è –ß–ú–¢ / –ø—Ä–æ–≥—Ä–µ—Å—Å –Ω–µ–≤—Ä–æ–ª–æ–≥–∏–∏",
      desc:"–ø–æ—Ç–µ—Ä—è —Å–æ–∑–Ω–∞–Ω–∏—è, —Å—É–¥–æ—Ä–æ–≥–∏, –Ω–∞—Ä–∞—Å—Ç–∞—é—â–∞—è —Å–ø—É—Ç–∞–Ω–Ω–æ—Å—Ç—å, –æ—á–∞–≥–æ–≤—ã–µ —Å–∏–º–ø—Ç–æ–º—ã",
      why:"–¢—è–∂—ë–ª–∞—è –ß–ú–¢/–Ω–µ–≤—Ä–æ–ª–æ–≥–∏—è"
    }
  ];

  // SCORE: –±–∞–ª–ª—ã —Å—É–º–º–∏—Ä—É–µ–º
  const SCORE = [
    {
      id:"bleedControlled",
      pts:3,
      title:"–¢—è–∂—ë–ª–æ–µ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º",
      desc:"—Ç–∞–º–ø–æ–Ω–∞–¥–∞/–¥–∞–≤—è—â–∞—è –¥–µ—Ä–∂–∏—Ç, –Ω–æ —Ä–∏—Å–∫ —Å—Ä—ã–≤–∞/–ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è",
      why:"–†–∏—Å–∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è"
    },
    {
      id:"chestRisk",
      pts:3,
      title:"–†–∞–Ω–µ–Ω–∏–µ –≥—Ä—É–¥–∏ (–∑–∞–∫—Ä—ã—Ç–æ/–∫–ª–∞–ø–∞–Ω), –Ω–æ —Ä–∏—Å–∫ —É—Ö—É–¥—à–µ–Ω–∏—è",
      desc:"–æ–¥—ã—à–∫–∞ —É–º–µ—Ä–µ–Ω–Ω–∞—è, –≤–æ–∑–º–æ–∂–µ–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å",
      why:"–†–∏—Å–∫ —É—Ö—É–¥—à–µ–Ω–∏—è –ø–æ –≥—Ä—É–¥–∏"
    },
    {
      id:"abdRisk",
      pts:3,
      title:"–ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–Ω–∏–∫–∞—é—â–µ–µ –∂–∏–≤–æ—Ç–∞/—Ç–∞–∑–∞ (–±–µ–∑ –∫—Ä–∏—Ç–∏–∫–∏)",
      desc:"–±–æ–ª—å/–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ, –Ω–æ –±–µ–∑ —è–≤–Ω–æ–≥–æ –∫–æ–ª–ª–∞–ø—Å–∞",
      why:"–†–∏—Å–∫ —Å–∫—Ä—ã—Ç–æ–≥–æ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è"
    },
    {
      id:"eye",
      pts:2,
      title:"–ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ —Ç—Ä–∞–≤–º—É –≥–ª–∞–∑–∞",
      desc:"–∏–Ω–æ—Ä–æ–¥–Ω–æ–µ/–ø—Ä–æ–Ω–∏–∫–∞—é—â–µ–µ/—Å–∏–ª—å–Ω–∞—è –±–æ–ª—å, —É—Ö—É–¥—à–µ–Ω–∏–µ –∑—Ä–µ–Ω–∏—è",
      why:"–¢—Ä–∞–≤–º–∞ –≥–ª–∞–∑–∞"
    },
    {
      id:"limbSerious",
      pts:2,
      title:"–°–µ—Ä—å—ë–∑–Ω–∞—è —Ç—Ä–∞–≤–º–∞ –∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏",
      desc:"–ø–µ—Ä–µ–ª–æ–º/–¥–µ—Ñ–æ—Ä–º–∞—Ü–∏—è/—Å–∏–ª—å–Ω–∞—è –±–æ–ª—å, –Ω—É–∂–Ω–∞ —Ö–∏—Ä—É—Ä–≥–∏—è/—Ñ–∏–∫—Å–∞—Ü–∏—è",
      why:"–¢—Ä–∞–≤–º–∞ –∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏"
    },
    {
      id:"burns",
      pts:2,
      title:"–û–∂–æ–≥–∏ –∑–Ω–∞—á–∏–º–æ–π –ø–ª–æ—â–∞–¥–∏/–∑–æ–Ω—ã",
      desc:"–ø—Ä–∏–º–µ—Ä–Ω–æ ‚â•10% –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –≤–∞–∂–Ω—ã–µ –∑–æ–Ω—ã",
      why:"–û–∂–æ–≥–∏"
    },
    {
      id:"infectionFlags",
      pts:1,
      title:"–ê–º–±—É–ª–∞—Ç–æ—Ä–Ω—ã–µ ¬´–∫—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏¬ª –∏–Ω—Ñ–µ–∫—Ü–∏–∏",
      desc:"–≤—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ + —É—Ö—É–¥—à–µ–Ω–∏–µ, –±—ã—Å—Ç—Ä–æ–µ –ø–æ–∫—Ä–∞—Å–Ω–µ–Ω–∏–µ/–æ—Ç—ë–∫, –≥–Ω–æ–π + —Å–ª–∞–±–æ—Å—Ç—å",
      why:"–†–∏—Å–∫ —É—Ö—É–¥—à–µ–Ω–∏—è/–∏–Ω—Ñ–µ–∫—Ü–∏–∏"
    },
    {
      id:"supportNeed",
      pts:1,
      title:"–ù—É–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞/–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ",
      desc:"–≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è —Å–ª–∞–±–æ—Å—Ç—å, —Å–ª–æ–∂–Ω–æ –∏–¥—Ç–∏, –Ω—É–∂–µ–Ω –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å",
      why:"–¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ"
    }
  ];

  // STABLE: –µ—Å–ª–∏ –æ—Ç–º–µ—á–µ–Ω–æ —Ç–æ–ª—å–∫–æ —ç—Ç–æ ‚Üí –ù–ê –ú–ï–°–¢–ï
  const STABLE = [
    {
      id:"stableOnly",
      title:"–°—Ç–∞–±–∏–ª—å–Ω–æ, –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ",
      desc:"–∫–æ–Ω—Ç—Ä–æ–ª—å –¥–µ—Ä–∂–∏—Ç, –Ω–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏, —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–æ–≤–Ω–æ–µ",
      why:"–°—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ"
    }
  ];

  // ===== DOM =====
  const $ = (id)=>document.getElementById(id);
  const toastEl = $("toast");
  const obsMinsEl = $("obsMins");
  obsMinsEl.textContent = String(OBS_MINUTES);

  const critList = $("critList");
  const scoreList = $("scoreList");
  const stabList = $("stabList");

  const critCountEl = $("critCount");
  const scoreSumEl = $("scoreSum");
  const stabCountEl = $("stabCount");

  const pickedCountEl = $("pickedCount");
  const critBadgeEl = $("critBadge");
  const scoreBadgeEl = $("scoreBadge");

  const resultBox = $("resultBox");
  const resTitle = $("resTitle");
  const resWhy = $("resWhy");
  const resRec = $("resRec");

  // ===== State (persist to localStorage) =====
  const KEY = "evac_quick_v1";
  let state = loadState();

  function loadState(){
    try{
      const raw = localStorage.getItem(KEY);
      if(!raw) return { checked:{} };
      const obj = JSON.parse(raw);
      if(!obj || typeof obj !== "object") return { checked:{} };
      if(!obj.checked) obj.checked = {};
      return obj;
    }catch(_){
      return { checked:{} };
    }
  }
  function saveState(){
    localStorage.setItem(KEY, JSON.stringify(state));
  }

  function toast(msg, ms=2200){
    toastEl.textContent = msg;
    toastEl.style.display = "block";
    clearTimeout(toastEl._t);
    toastEl._t = setTimeout(()=>toastEl.style.display="none", ms);
  }

  // ===== UI builders =====
  function makeItem(def, group){
    // group: "crit" | "score" | "stab"
    const wrap = document.createElement("div");
    wrap.className = "item";

    const cb = document.createElement("input");
    cb.type = "checkbox";
    cb.checked = !!state.checked[def.id];

    cb.addEventListener("change", ()=>{
      state.checked[def.id] = cb.checked ? 1 : 0;
      if(!cb.checked) delete state.checked[def.id];
      saveState();
      recalc();
    });

    const content = document.createElement("div");
    const t = document.createElement("div");
    t.className = "itTitle";
    t.textContent = def.title;

    const d = document.createElement("div");
    d.className = "itDesc";
    d.textContent = def.desc || "";

    const meta = document.createElement("div");
    meta.className = "meta";

    if(group === "crit"){
      meta.innerHTML = `<span class="tag crit">–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π</span>`;
    }else if(group === "score"){
      meta.innerHTML = `<span class="tag score">${def.pts} –±–∞–ª–ª(–æ–≤)</span>`;
    }else{
      meta.innerHTML = `<span class="tag stab">—Å—Ç–∞–±–∏–ª—å–Ω–æ</span>`;
    }

    content.appendChild(t);
    if(def.desc) content.appendChild(d);
    content.appendChild(meta);

    // Tapping the whole card toggles too
    wrap.addEventListener("pointerdown", (e)=>{
      // prevent double toggle when tap directly on checkbox
      if(e.target === cb) return;
      e.preventDefault();
      cb.checked = !cb.checked;
      cb.dispatchEvent(new Event("change"));
    });

    wrap.appendChild(cb);
    wrap.appendChild(content);
    return wrap;
  }

  function renderLists(){
    critList.innerHTML = "";
    scoreList.innerHTML = "";
    stabList.innerHTML = "";

    CRIT.forEach(x => critList.appendChild(makeItem(x, "crit")));
    SCORE.forEach(x => scoreList.appendChild(makeItem(x, "score")));
    STABLE.forEach(x => stabList.appendChild(makeItem(x, "stab")));
  }

  // ===== Core logic =====
  function recalc(){
    const checked = state.checked || {};
    const pickedIds = Object.keys(checked);

    let crit = [];
    let score = 0;
    let stab = [];

    // Critical
    for(const c of CRIT){
      if(checked[c.id]) crit.push(c);
    }
    // Score
    for(const s of SCORE){
      if(checked[s.id]) score += (s.pts || 0);
    }
    // Stable
    for(const st of STABLE){
      if(checked[st.id]) stab.push(st);
    }

    // counts
    critCountEl.textContent = String(crit.length);
    scoreSumEl.textContent = String(score);
    stabCountEl.textContent = String(stab.length);

    pickedCountEl.textContent = String(pickedIds.length);
    critBadgeEl.textContent = crit.length ? "–î–ê" : "–ù–ï–¢";
    scoreBadgeEl.textContent = String(score);

    // Determine category
    const onlyStable = (pickedIds.length > 0)
      && crit.length === 0
      && score === 0
      && stab.length > 0;

    let category = "NONE";
    if(crit.length) category = "NOW";
    else if(onlyStable) category = "ON_SITE";
    else if(pickedIds.length === 0) category = "NONE";
    else if(score >= THRESH_SOON) category = "SOON";
    else if(score >= THRESH_PLAN) category = "PLAN";
    else category = "ON_SITE";

    // Compose reasons (whys)
    const reasons = [];
    if(crit.length) reasons.push(...crit.map(x=>x.why));
    // Add top scoring "why" in a useful way (avoid spam)
    if(!crit.length){
      for(const s of SCORE){
        if(checked[s.id]) reasons.push(s.why);
      }
      if(stab.length) reasons.push(...stab.map(x=>x.why));
    }

    // Build recommendations
    const rec = buildRecommendations(category, {crit, score, pickedCount:pickedIds.length});

    // Render box
    renderResult(category, reasons, score, rec);

    // Update copy text cache
    window.__EVAC_EXPORT__ = buildExportText(category, reasons, score, rec);
  }

  function buildRecommendations(category, ctx){
    const obs = OBS_MINUTES;
    const baseRedFlags = [
      "–ü—Ä–∏ —É—Ö—É–¥—à–µ–Ω–∏–∏ (–¥—ã—Ö–∞–Ω–∏–µ/—Å–æ–∑–Ω–∞–Ω–∏–µ/–∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ/–±–æ–ª—å) ‚Äî –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –∏ –ø–æ–≤—ã—à–∞—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —ç–≤–∞–∫—É–∞—Ü–∏–∏.",
      "–ö–æ–Ω—Ç—Ä–æ–ª—å –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è/–ø–æ–≤—è–∑–æ–∫, —Ç–µ–ø–ª–æ, –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏–π, –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ."
    ];

    if(category === "NOW"){
      return [
        "–≠–í–ê–ö–£–ê–¶–ò–Ø: –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ (¬´–°–ï–ô–ß–ê–°¬ª).",
        "–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ: —Ñ–∏–∫—Å–∞—Ü–∏—è, —Ç–µ–ø–ª–æ, –∫–æ–Ω—Ç—Ä–æ–ª—å –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è/–¥—ã—Ö–∞–Ω–∏—è.",
        "–ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞–∂–¥—ã–µ 5‚Äì10 –º–∏–Ω—É—Ç –¥–æ –ø–µ—Ä–µ–¥–∞—á–∏/–ø–æ–≥—Ä—É–∑–∫–∏.",
        ...baseRedFlags
      ];
    }
    if(category === "SOON"){
      return [
        "–≠–í–ê–ö–£–ê–¶–ò–Ø: –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ (¬´–°–ö–û–†–û¬ª).",
        `–ù–∞–±–ª—é–¥–µ–Ω–∏–µ –¥–æ —ç–≤–∞–∫—É–∞—Ü–∏–∏: –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞–∂–¥—ã–µ ${obs} –º–∏–Ω—É—Ç.`,
        "–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –Ω–æ—Å–∏–ª–∫–∏/–º–∞—Ä—à—Ä—É—Ç/—Å–≤—è–∑—å –∑–∞—Ä–∞–Ω–µ–µ, –¥–µ—Ä–∂–∞—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —É—Ö—É–¥—à–µ–Ω–∏—é.",
        ...baseRedFlags
      ];
    }
    if(category === "PLAN"){
      return [
        "–≠–í–ê–ö–£–ê–¶–ò–Ø: –ø–ª–∞–Ω–æ–≤–æ –ø—Ä–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.",
        `–ù–∞–±–ª—é–¥–µ–Ω–∏–µ: –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞–∂–¥—ã–µ ${obs} –º–∏–Ω—É—Ç (–ø—Ä–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª).`,
        "–õ–µ—á–µ–Ω–∏–µ –Ω–∞ –º–µ—Å—Ç–µ + –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —ç–≤–∞–∫—É–∞—Ü–∏–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∏/—É—Ö—É–¥—à–µ–Ω–∏–∏.",
        ...baseRedFlags
      ];
    }
    if(category === "ON_SITE"){
      return [
        "–ù–ê –ú–ï–°–¢–ï: –Ω–∞–±–ª—é–¥–∞—Ç—å / –∫—É–ø–∏—Ä–æ–≤–∞—Ç—å.",
        `–ö–æ–Ω—Ç—Ä–æ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞–∂–¥—ã–µ ${obs} –º–∏–Ω—É—Ç (–ø—É–ª—å—Å/–¥—ã—Ö–∞–Ω–∏–µ/—Å–æ–∑–Ω–∞–Ω–∏–µ/–∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ/–±–æ–ª—å).`,
        "–û–±–µ–∑–±–æ–ª–∏–≤–∞–Ω–∏–µ –ø–æ –≤–∞—à–µ–º—É –ø—Ä–æ—Ç–æ–∫–æ–ª—É, —Ç–µ–ø–ª–æ, –ø–æ–∫–æ–π, –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–æ–≤—è–∑–æ–∫.",
        "–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–ª–∞–Ω —ç–≤–∞–∫—É–∞—Ü–∏–∏ ¬´–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π¬ª (–º–∞—Ä—à—Ä—É—Ç/–Ω–æ—Å–∏–ª–∫–∏/—Å–≤—è–∑—å).",
        "–ö—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞: –Ω–∞—Ä–∞—Å—Ç–∞—é—â–∞—è –±–æ–ª—å, —É—Ö—É–¥—à–µ–Ω–∏–µ –¥—ã—Ö–∞–Ω–∏—è, —Å–ª–∞–±–æ—Å—Ç—å/–æ–±–º–æ—Ä–æ–∫, –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ, —É—Ö—É–¥—à–µ–Ω–∏–µ –∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏ (—Ö–æ–ª–æ–¥/–±–ª–µ–¥–Ω–æ—Å—Ç—å/–æ–Ω–µ–º–µ–Ω–∏–µ)."
      ];
    }
    // NONE
    return [
      "–û—Ç–º–µ—Ç—å—Ç–µ –ø—É–Ω–∫—Ç—ã –≤—ã—à–µ ‚Äî –ø–æ—è–≤–∏—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.",
      "–ï—Å–ª–∏ —Å–æ–º–Ω–µ–≤–∞–µ—Ç–µ—Å—å ‚Äî –æ—Ç–º–µ—Ç—å—Ç–µ –±–ª–∏–∂–∞–π—à–∏–π –ø–æ —Å–º—ã—Å–ª—É –ø—É–Ω–∫—Ç (–ª—É—á—à–µ –ø–µ—Ä–µ—Å—Ç—Ä–∞—Ö–æ–≤–∞—Ç—å—Å—è)."
    ];
  }

  function renderResult(category, reasons, score, rec){
    // reset classes
    resultBox.className = "resultBox";

    let title = "–ü–æ–∫–∞ –Ω–µ –æ—Ü–µ–Ω–µ–Ω–æ";
    if(category === "NOW"){
      resultBox.classList.add("red");
      title = "–°–ï–ô–ß–ê–° ‚Äî –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è —ç–≤–∞–∫—É–∞—Ü–∏—è";
    }else if(category === "SOON"){
      resultBox.classList.add("orange");
      title = "–°–ö–û–†–û ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è —ç–≤–∞–∫—É–∞—Ü–∏—è";
    }else if(category === "PLAN"){
      resultBox.classList.add("yellow");
      title = "–ü–õ–ê–ù–û–í–û ‚Äî –ø—Ä–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏";
    }else if(category === "ON_SITE"){
      resultBox.classList.add("green");
      title = "–ù–ê –ú–ï–°–¢–ï ‚Äî –Ω–∞–±–ª—é–¥–∞—Ç—å / –∫—É–ø–∏—Ä–æ–≤–∞—Ç—å";
    }

    resTitle.textContent = title;

    if(reasons.length){
      // compact reasons
      const uniq = [];
      const seen = {};
      for(const r of reasons){
        if(!seen[r]){ seen[r]=1; uniq.push(r); }
      }
      resWhy.textContent = "–ü—Ä–∏—á–∏–Ω—ã: " + uniq.join("; ");
    }else{
      resWhy.textContent = "–ü—Ä–∏—á–∏–Ω—ã: (–Ω–µ—Ç)";
    }

    resRec.innerHTML = "";
    for(const r of rec){
      const li = document.createElement("li");
      li.textContent = r;
      resRec.appendChild(li);
    }
  }

  function buildExportText(category, reasons, score, rec){
    const ts = new Date();
    const dt = ts.toLocaleString("ru-RU");
    const catName = (
      category==="NOW" ? "–°–ï–ô–ß–ê–° ‚Äî –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è —ç–≤–∞–∫—É–∞—Ü–∏—è" :
      category==="SOON" ? "–°–ö–û–†–û ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è —ç–≤–∞–∫—É–∞—Ü–∏—è" :
      category==="PLAN" ? "–ü–õ–ê–ù–û–í–û ‚Äî –ø—Ä–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏" :
      category==="ON_SITE" ? "–ù–ê –ú–ï–°–¢–ï ‚Äî –Ω–∞–±–ª—é–¥–∞—Ç—å/–∫—É–ø–∏—Ä–æ–≤–∞—Ç—å" :
      "–ù–ï –û–¶–ï–ù–ï–ù–û"
    );

    const uniq = [];
    const seen = {};
    for(const r of (reasons||[])){
      if(!seen[r]){ seen[r]=1; uniq.push(r); }
    }

    let out = [];
    out.push("–≠–í–ê–ö–£–ê–¶–ò–Ø ‚Äî –±—ã—Å—Ç—Ä–∞—è –æ—Ü–µ–Ω–∫–∞");
    out.push("–í—Ä–µ–º—è: " + dt);
    out.push("–ö–∞—Ç–µ–≥–æ—Ä–∏—è: " + catName);
    out.push("–ë–∞–ª–ª—ã: " + String(score||0));
    out.push("–ü—Ä–∏—á–∏–Ω—ã: " + (uniq.length ? uniq.join("; ") : "(–Ω–µ—Ç)"));
    out.push("");
    out.push("–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:");
    for(const r of (rec||[])){
      out.push("‚Ä¢ " + r);
    }
    return out.join("\n");
  }

  // ===== Buttons =====
  $("btnCopy").addEventListener("pointerdown", async (e)=>{
    e.preventDefault();
    const text = window.__EVAC_EXPORT__ || buildExportText("NONE", [], 0, []);
    try{
      await navigator.clipboard.writeText(text);
      toast("‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ");
    }catch(_){
      toast("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å. –í—ã–¥–µ–ª–∏ –∏ —Å–∫–æ–ø–∏—Ä—É–π –≤—Ä—É—á–Ω—É—é.", 3200);
    }
  });

  $("btnReset").addEventListener("pointerdown", (e)=>{
    e.preventDefault();
    state = { checked:{} };
    saveState();
    renderLists(); // rerender to reflect unchecked
    recalc();
    toast("–°–±—Ä–æ—à–µ–Ω–æ");
  });

  // ===== init =====
  renderLists();
  recalc();

})();
</script>
</body>
</html>
```Ó®Å0Ó®Ç
