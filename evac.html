<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>–≠–≤–∞–∫—É–∞—Ü–∏—è ‚Äî –ë—ã—Å—Ç—Ä–∞—è –æ—Ü–µ–Ω–∫–∞</title>
<style>
  body{ margin:0; font-family: Arial, sans-serif; background:#fff; color:#111; }
  header{
    position:sticky; top:0; z-index:10;
    background:#0b6623; color:#fff;
    padding:12px 12px; text-align:center;
    font-weight:800; font-size:18px;
  }
  .sub{
    padding:10px 12px; font-size:13px; color:#333;
    background:#f4f7f5; border-bottom:1px solid #dfe7e2;
  }

  .wrap{ padding:12px; max-width:920px; margin:0 auto; }

  .card{
    border:1px solid #e6e6e6; border-radius:14px;
    background:#fff; padding:12px; margin:10px 0;
    box-shadow:0 1px 6px rgba(0,0,0,0.05);
  }
  .card h2{ margin:0 0 8px; font-size:16px; }
  .hint{ font-size:12px; color:#666; margin-top:6px; }

  .q{
    display:flex; align-items:flex-start; gap:10px;
    padding:10px; border:1px solid #eee; border-radius:12px;
    background:#fafafa; margin:10px 0;
    touch-action: manipulation;
  }
  .q input{ width:22px; height:22px; margin-top:2px; flex:0 0 auto; }
  .q .txt{ font-size:14px; }
  .q .small{ font-size:12px; color:#555; margin-top:4px; }

  details{ margin-top:10px; }
  details summary{ cursor:pointer; font-weight:700; padding:10px; border:1px solid #eee; border-radius:12px; background:#fafafa; }
  .chips{ display:flex; flex-wrap:wrap; gap:8px; margin-top:10px; }
  .chip{ font-size:12px; padding:6px 10px; border-radius:999px; border:1px solid #ddd; background:#fff; }

  .row{ display:flex; gap:10px; }
  .col{ width:100%; }

  label{ display:block; font-size:13px; color:#444; margin:10px 0 6px; }
  input[type="text"], input[type="datetime-local"], textarea{
    width:100%; box-sizing:border-box;
    padding:10px; font-size:15px;
    border:1px solid #ccc; border-radius:10px;
    background:#fff;
  }
  textarea{ min-height:60px; }

  .btnRow{ display:flex; gap:10px; margin-top:10px; flex-wrap:wrap; }
  .btn{
    flex:1 1 180px;
    padding:14px; font-size:16px;
    border:none; border-radius:12px; color:#fff;
    background:#0b6623; touch-action: manipulation;
  }
  .btn:active{ opacity:.85; }
  .btn.secondary{ background:#2a76d2; }
  .btn.light{ background:#444; }
  .btn.white{
    background:#fff; color:#111; border:1px solid #222;
  }

  .result{
    padding:12px; border-radius:14px; margin-top:10px;
    border:2px solid transparent;
  }
  .rRed{ background:#fff0f0; border-color:#d33; }
  .rYel{ background:#fff8e8; border-color:#d6a100; }
  .rGrn{ background:#eefaf0; border-color:#1a8a37; }

  .big{
    font-size:18px; font-weight:900; margin:0 0 8px;
  }
  .reasons{ font-size:14px; margin:0; white-space:pre-wrap; }

  .out{
    margin-top:10px;
    white-space:pre-wrap;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    font-size:12px;
    padding:10px; border:1px solid #ddd; border-radius:12px;
    background:#fff;
  }

  .toast{
    position:fixed; left:50%; bottom:16px; transform:translateX(-50%);
    background:rgba(0,0,0,0.85); color:#fff;
    padding:10px 12px; border-radius:12px;
    font-size:14px; max-width:92%;
    z-index:9999; display:none; white-space:pre-wrap;
  }

  .reqBad{ border-color:#d11 !important; box-shadow:0 0 0 3px rgba(209,17,17,0.15); }

  .scoreBox{
    margin-top:8px;
    display:flex; gap:8px; flex-wrap:wrap; align-items:center;
  }
  .scorePill{
    font-size:12px; padding:6px 10px; border-radius:999px;
    background:#fff; border:1px solid #ddd;
  }
  .legend{
    font-size:12px; color:#666; margin-top:8px;
    line-height:1.35;
  }
</style>
</head>
<body>

<header>–≠–í–ê–ö–£–ê–¶–ò–Ø ‚Äî –ë–´–°–¢–†–ê–Ø –û–¶–ï–ù–ö–ê</header>
<div class="sub">
  –û—Ç–º–µ—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ ‚Üí –ø–æ–ª—É—á–∏—à—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é —ç–≤–∞–∫—É–∞—Ü–∏–∏, –ø—Ä–∏—á–∏–Ω—ã, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ –≥–æ—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏/Telegram. –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω.
</div>

<div class="wrap">

  <div class="card">
    <h2>–î–∞–Ω–Ω—ã–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</h2>
    <div class="row">
      <div class="col">
        <label>–î–∞—Ç–∞/–≤—Ä–µ–º—è</label>
        <input id="dt" type="datetime-local">
      </div>
      <div class="col">
        <label>–ü–æ–∑—ã–≤–Ω–æ–π</label>
        <input id="call" type="text" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: –ë–ê–†–°-12">
      </div>
    </div>

    <label>–ö—Ä–∞—Ç–∫–æ (—á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ / —á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ)</label>
    <textarea id="brief" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: –æ—Å–∫–æ–ª–æ—á–Ω–æ–µ; –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è; –¥—ã—Ö–∞–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ; –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –∫ —ç–≤–∞–∫—É–∞—Ü–∏–∏..."></textarea>

    <div class="hint">
      –ë–µ–∑ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö –ø–æ–ª–µ–π –Ω–µ –¥–∞–¥–∏–º –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å/Telegram ‚Äî —á—Ç–æ–±—ã –Ω–µ —É—Ö–æ–¥–∏–ª–∏ –ø—É—Å—Ç—ã–µ –¥–æ–∫–ª–∞–¥—ã.
    </div>
  </div>

  <div class="card">
    <h2>–ü—É–Ω–∫—Ç—ã –æ—Ü–µ–Ω–∫–∏ (—Ç–∞–ø–∞–π –≥–∞–ª–æ—á–∫–∏)</h2>

    <details open>
      <summary>üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (–µ—Å–ª–∏ –æ—Ç–º–µ—á–µ–Ω–æ ‚Üí –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ ¬´–°–ï–ô–ß–ê–°¬ª)</summary>

      <div class="q">
        <input type="checkbox" id="q_bleed_uncontrolled">
        <div class="txt">
          <div><b>–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ –ù–ï –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è</b> (–ª—å—ë—Ç, –¥–∞–≤—è—â–∞—è/–∂–≥—É—Ç –Ω–µ –¥–µ—Ä–∂–∏—Ç)</div>
          <div class="small">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É–Ω–∫—Ç</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_airway_problem">
        <div class="txt">
          <div><b>–ü—Ä–æ–±–ª–µ–º–∞ —Å –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø—É—Ç—è–º–∏</b> (–æ–±—Å—Ç—Ä—É–∫—Ü–∏—è/—É–≥—Ä–æ–∑–∞, –Ω–µ –¥–µ—Ä–∂–∏—Ç —è–∑—ã–∫, —Ö—Ä–∏–ø—ã/—Å—Ä—ã–≤)</div>
          <div class="small">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É–Ω–∫—Ç</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_resp_fail">
        <div class="txt">
          <div><b>–î—ã—Ö–∞–Ω–∏–µ —É—Ö—É–¥—à–∞–µ—Ç—Å—è</b> (–Ω–∞—Ä–∞—Å—Ç–∞–µ—Ç –æ–¥—ã—à–∫–∞/—Ü–∏–∞–Ω–æ–∑/–∞—Å–∏–º–º–µ—Ç—Ä–∏—è)</div>
          <div class="small">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É–Ω–∫—Ç</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_shock_signs">
        <div class="txt">
          <div><b>–ü—Ä–∏–∑–Ω–∞–∫–∏ —à–æ–∫–∞ / —É—Ö—É–¥—à–µ–Ω–∏–µ</b> (–ø–æ—Ö–æ–ª–æ–¥–∞–Ω–∏–µ, –±–ª–µ–¥–Ω–æ—Å—Ç—å, —Å–ª–∞–±—ã–π –ø—É–ª—å—Å, —Å–ø—É—Ç–∞–Ω–Ω–æ—Å—Ç—å)</div>
          <div class="small">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É–Ω–∫—Ç</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_conscious_down">
        <div class="txt">
          <div><b>–°–æ–∑–Ω–∞–Ω–∏–µ —É—Ö—É–¥—à–∞–µ—Ç—Å—è</b> (–æ–≥–ª—É—à–µ–Ω–∏–µ/–ø–æ—Ç–µ—Ä—è/—Å—É–¥–æ—Ä–æ–≥–∏/–Ω–∞—Ä–∞—Å—Ç–∞–µ—Ç —Å–ø—É—Ç–∞–Ω–Ω–æ—Å—Ç—å)</div>
          <div class="small">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É–Ω–∫—Ç</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_tbi_redflags">
        <div class="txt">
          <div><b>–¢–ß–ú–¢: ‚Äúred flags‚Äù</b> (–ø–æ—Ç–µ—Ä—è —Å–æ–∑–Ω–∞–Ω–∏—è, –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–∞—è —Ä–≤–æ—Ç–∞, —Å—É–¥–æ—Ä–æ–≥–∏, –Ω–µ—Ä–∞–≤–Ω—ã–µ –∑—Ä–∞—á–∫–∏, –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è)</div>
          <div class="small">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É–Ω–∫—Ç</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_burn_gt20">
        <div class="txt">
          <div><b>–û–∂–æ–≥–∏ &gt; 20% –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏</b> –∏–ª–∏ –æ–∂–æ–≥–∏ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π/–ª–∏—Ü–∞ —Å —É—Ö—É–¥—à–µ–Ω–∏–µ–º –¥—ã—Ö–∞–Ω–∏—è</div>
          <div class="small">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É–Ω–∫—Ç</div>
        </div>
      </div>
    </details>

    <details open>
      <summary>üü° –ó–Ω–∞—á–∏–º—ã–µ (–¥–∞—é—Ç –±–∞–ª–ª—ã ‚Äî –∏—Ç–æ–≥ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—É–º–º—ã)</summary>

      <div class="q">
        <input type="checkbox" id="q_tq_in_place">
        <div class="txt">
          <div><b>–ñ–≥—É—Ç –Ω–∞–ª–æ–∂–µ–Ω</b> (–∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º)</div>
          <div class="small">–ë–∞–ª–ª—ã (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤—ã—à–µ –∏–∑-–∑–∞ —Ä–∏—Å–∫–∞ –∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏)</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_bleed_controlled">
        <div class="txt">
          <div><b>–¢—è–∂—ë–ª–æ–µ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º</b> (—Ç–∞–º–ø–æ–Ω–∞–¥–∞/–¥–∞–≤—è—â–∞—è –¥–µ—Ä–∂–∏—Ç, —Ä–∏—Å–∫ —Å—Ä—ã–≤–∞)</div>
          <div class="small">–ë–∞–ª–ª—ã</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_chest_wound">
        <div class="txt">
          <div><b>–†–∞–Ω–µ–Ω–∏–µ –≥—Ä—É–¥–∏</b> (–∑–∞–∫—Ä—ã—Ç–æ/–∫–ª–∞–ø–∞–Ω, –Ω–æ —Ä–∏—Å–∫ —É—Ö—É–¥—à–µ–Ω–∏—è)</div>
          <div class="small">–ë–∞–ª–ª—ã</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_abd_pelvis_penetrating">
        <div class="txt">
          <div><b>–ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–Ω–∏–∫–∞—é—â–µ–µ —Ä–∞–Ω–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–∞/—Ç–∞–∑–∞</b> (–±–æ–ª—å, –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ, —É—Ö—É–¥—à–µ–Ω–∏–µ)</div>
          <div class="small">–ë–∞–ª–ª—ã</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_fracture_major">
        <div class="txt">
          <div><b>–°–µ—Ä—å—ë–∑–Ω–∞—è —Ç—Ä–∞–≤–º–∞ –∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏</b> (–ø–µ—Ä–µ–ª–æ–º/–¥–µ—Ñ–æ—Ä–º–∞—Ü–∏—è/—Å–∏–ª—å–Ω–∞—è –±–æ–ª—å, –Ω—É–∂–Ω–∞ —Ö–∏—Ä—É—Ä–≥–∏—è)</div>
          <div class="small">–ë–∞–ª–ª—ã</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_eye_penetrating">
        <div class="txt">
          <div><b>–ü—Ä–æ–Ω–∏–∫–∞—é—â–∞—è —Ç—Ä–∞–≤–º–∞ –≥–ª–∞–∑–∞</b></div>
          <div class="small">–ë–∞–ª–ª—ã</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_burn_10_20">
        <div class="txt">
          <div><b>–û–∂–æ–≥–∏ 10‚Äì20% –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏</b></div>
          <div class="small">–ë–∞–ª–ª—ã</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_infection_redflags">
        <div class="txt">
          <div><b>–ê–º–±—É–ª–∞—Ç–æ—Ä–Ω—ã–µ ‚Äú–∫—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏‚Äù</b> (–≤—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ + —É—Ö—É–¥—à–µ–Ω–∏–µ, –±—ã—Å—Ç—Ä–æ–µ –ø–æ–∫—Ä–∞—Å–Ω–µ–Ω–∏–µ/–æ—Ç—ë–∫, –≥–Ω–æ–π + —Å–ª–∞–±–æ—Å—Ç—å)</div>
          <div class="small">–ë–∞–ª–ª—ã</div>
        </div>
      </div>

      <div class="q">
        <input type="checkbox" id="q_need_iv_support">
        <div class="txt">
          <div><b>–ù—É–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞/–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ</b> (–≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è —Å–ª–∞–±–æ—Å—Ç—å, –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–¥—Ç–∏, –Ω—É–∂–µ–Ω –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å)</div>
          <div class="small">–ë–∞–ª–ª—ã</div>
        </div>
      </div>
    </details>

    <details>
      <summary>üü¢ –°—Ç–∞–±–∏–ª—å–Ω–æ (–¥–ª—è ¬´–Ω–∞–±–ª—é–¥–∞—Ç—å¬ª)</summary>

      <div class="q">
        <input type="checkbox" id="q_stable_minor">
        <div class="txt">
          <div><b>–°—Ç–∞–±–∏–ª—å–Ω–æ, –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ</b> (–∫–æ–Ω—Ç—Ä–æ–ª—å, –Ω–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏)</div>
          <div class="small">–ï—Å–ª–∏ –æ—Ç–º–µ—á–µ–Ω–æ —Ç–æ–ª—å–∫–æ —ç—Ç–æ ‚Äî –º–æ–∂–Ω–æ –Ω–∞–±–ª—é–¥–∞—Ç—å</div>
        </div>
      </div>
    </details>

    <div class="legend">
      –õ–æ–≥–∏–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:
      <br>‚Ä¢ –ï—Å–ª–∏ –æ—Ç–º–µ—á–µ–Ω –ª—é–±–æ–π <b>–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π</b> –ø—É–Ω–∫—Ç ‚Üí üî¥ ¬´–°–ï–ô–ß–ê–°¬ª
      <br>‚Ä¢ –ò–Ω–∞—á–µ —Å—á–∏—Ç–∞–µ–º <b>–±–∞–ª–ª—ã</b>: ‚â•6 ‚Üí üî¥, 3‚Äì5 ‚Üí üü°, &lt;3 ‚Üí üü° (–µ—Å–ª–∏ —Ö–æ—Ç—å —á—Ç–æ-—Ç–æ –æ—Ç–º–µ—á–µ–Ω–æ), –∏ —Ç–æ–ª—å–∫–æ ‚Äú—Å—Ç–∞–±–∏–ª—å–Ω–æ‚Äù ‚Üí üü¢
      <br>‚Ä¢ –ü–æ—Ä–æ–≥–∏ –º–æ–∂–Ω–æ –ø–æ–¥—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥ –≤–∞—à–∏ —Ä–µ–∞–ª–∏–∏ (–≤ –∫–æ–¥–µ –µ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏).
    </div>
  </div>

  <div class="card">
    <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>

    <div class="scoreBox">
      <span class="scorePill" id="scorePill">–ë–∞–ª–ª—ã: 0</span>
      <span class="scorePill" id="critPill">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ: –Ω–µ—Ç</span>
      <span class="scorePill" id="pickedPill">–û—Ç–º–µ—á–µ–Ω–æ: 0</span>
    </div>

    <div id="resultBox" class="result rGrn">
      <div id="resultTitle" class="big">–ü–æ–∫–∞ –Ω–µ –æ—Ü–µ–Ω–µ–Ω–æ</div>
      <p id="resultReasons" class="reasons">–û—Ç–º–µ—Ç—å –ø—É–Ω–∫—Ç—ã –≤—ã—à–µ ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</p>
    </div>

    <div class="btnRow">
      <button class="btn" id="btnCopy" type="button">–ö–û–ü–ò–†–û–í–ê–¢–¨ –¢–ï–ö–°–¢</button>
      <button class="btn secondary" id="btnTG" type="button">TELEGRAM</button>
      <button class="btn white" id="btnReset" type="button">–°–ë–†–û–°–ò–¢–¨</button>
    </div>

    <div class="out" id="finalText"></div>
  </div>

  <div class="card">
    <h2>–ù–∞–≤–∏–≥–∞—Ü–∏—è</h2>
    <div class="btnRow">
      <button class="btn light" type="button" onclick="location.href='index.html'">‚¨ÖÔ∏è –ö –ö–ê–†–¢–ï –†–ê–ù–ï–ù–ò–ô</button>
      <button class="btn light" type="button" onclick="scrollTo({top:0,behavior:'smooth'})">‚¨ÜÔ∏è –í–í–ï–†–•</button>
    </div>
    <div class="hint">
      ‚ö†Ô∏è –≠—Ç–æ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (–Ω–µ ‚Äú–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ‚Äù). –°–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∏ —Å—Ç–∞—Ä—à–∏—Ö –º–µ–¥–∏–∫–æ–≤.
    </div>
  </div>

</div>

<div id="toast" class="toast"></div>

<script>
(function(){
  const $ = (id)=>document.getElementById(id);
  const toastEl = $("toast");

  function toast(msg, ms){
    toastEl.textContent = msg;
    toastEl.style.display = "block";
    clearTimeout(toastEl._t);
    toastEl._t = setTimeout(()=>{ toastEl.style.display="none"; }, ms || 2400);
  }

  // –ê–≤—Ç–æ-–≤—Ä–µ–º—è
  const dtEl = $("dt");
  if(!dtEl.value){
    const d=new Date();
    const pad=(n)=>String(n).padStart(2,"0");
    dtEl.value = `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}T${pad(d.getHours())}:${pad(d.getMinutes())}`;
  }

  const callEl = $("call");
  const briefEl = $("brief");

  function markReq(el, ok){
    if(ok) el.classList.remove("reqBad"); else el.classList.add("reqBad");
  }
  function validateRequired(){
    const dt=(dtEl.value||"").trim();
    const call=(callEl.value||"").trim();
    const brief=(briefEl.value||"").trim();
    const okDt=!!dt, okCall=!!call, okBrief=!!brief;
    markReq(dtEl, okDt);
    markReq(callEl, okCall);
    markReq(briefEl, okBrief);
    const miss=[];
    if(!okDt) miss.push("–î–∞—Ç–∞/–≤—Ä–µ–º—è");
    if(!okCall) miss.push("–ü–æ–∑—ã–≤–Ω–æ–π");
    if(!okBrief) miss.push("–ö—Ä–∞—Ç–∫–æ");
    return {ok: okDt && okCall && okBrief, missing: miss};
  }

  // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–æ–≤
  const SCORE_RED = 6;   // >=6 ‚Üí RED
  const SCORE_YEL = 3;   // >=3 ‚Üí YEL (–µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–µ—Ç)
  // –µ—Å–ª–∏ –æ—Ç–º–µ—á–µ–Ω–æ —á—Ç–æ-—Ç–æ, –Ω–æ –±–∞–ª–ª–æ–≤ –º–∞–ª–æ ‚Äî –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é YEL (–ª—É—á—à–µ –ø–µ—Ä–µ—Å—Ç—Ä–∞—Ö–æ–≤–∞—Ç—å—Å—è)

  // –°–ø–∏—Å–æ–∫ –ø—É–Ω–∫—Ç–æ–≤ (id –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å HTML)
  const QUESTIONS = [
    // –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï
    {id:"q_bleed_uncontrolled", kind:"critical", points:5, reason:"–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ –Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è", recs:[
      "–ö–æ–Ω—Ç—Ä–æ–ª—å –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è (–∂–≥—É—Ç/—Ç–∞–º–ø–æ–Ω–∞–¥–∞/–¥–∞–≤—è—â–∞—è) –∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è —ç–≤–∞–∫—É–∞—Ü–∏—è."
    ]},
    {id:"q_airway_problem", kind:"critical", points:5, reason:"–ü—Ä–æ–±–ª–µ–º–∞ —Å –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø—É—Ç—è–º–∏", recs:[
      "–û–±–µ—Å–ø–µ—á–∏—Ç—å –ø—Ä–æ—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π, –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å."
    ]},
    {id:"q_resp_fail", kind:"critical", points:5, reason:"–î—ã—Ö–∞–Ω–∏–µ —É—Ö—É–¥—à–∞–µ—Ç—Å—è", recs:[
      "–ö–æ–Ω—Ç—Ä–æ–ª—å –¥—ã—Ö–∞–Ω–∏—è, –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —É—Ö—É–¥—à–µ–Ω–∏–µ, –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —Ä–µ–∑–∫–æ–º —Å–ø–∞–¥–µ–Ω–∏–∏."
    ]},
    {id:"q_shock_signs", kind:"critical", points:5, reason:"–ü—Ä–∏–∑–Ω–∞–∫–∏ —à–æ–∫–∞ / —É—Ö—É–¥—à–µ–Ω–∏–µ", recs:[
      "–¢–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏—è, –∫–æ–Ω—Ç—Ä–æ–ª—å –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, —É—Å–∫–æ—Ä–µ–Ω–∏–µ —ç–≤–∞–∫—É–∞—Ü–∏–∏."
    ]},
    {id:"q_conscious_down", kind:"critical", points:5, reason:"–°–æ–∑–Ω–∞–Ω–∏–µ —É—Ö—É–¥—à–∞–µ—Ç—Å—è", recs:[
      "–ö–æ–Ω—Ç—Ä–æ–ª—å –¥—ã—Ö–∞–Ω–∏—è/–ø–æ–ª–æ–∂–µ–Ω–∏—è, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–∑–Ω–∞–Ω–∏—è, —É—Å–∫–æ—Ä–∏—Ç—å —ç–≤–∞–∫—É–∞—Ü–∏—é."
    ]},
    {id:"q_tbi_redflags", kind:"critical", points:4, reason:"–¢–ß–ú–¢: red flags", recs:[
      "–ù–∞–±–ª—é–¥–µ–Ω–∏–µ —Å–æ–∑–Ω–∞–Ω–∏—è/–∑—Ä–∞—á–∫–æ–≤, –∏—Å–∫–ª—é—á–∏—Ç—å —É—Ö—É–¥—à–µ–Ω–∏–µ, —ç–≤–∞–∫—É–∞—Ü–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ."
    ]},
    {id:"q_burn_gt20", kind:"critical", points:4, reason:"–û–∂–æ–≥–∏ > 20% / –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏", recs:[
      "–¢–µ–ø–ª–æ, –∑–∞—â–∏—Ç–∞ –æ–∂–æ–≥–æ–≤–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è —ç–≤–∞–∫—É–∞—Ü–∏—è."
    ]},

    // –ë–ê–õ–õ–¨–ù–´–ï
    {id:"q_tq_in_place", kind:"score", points:2, reason:"–ñ–≥—É—Ç –Ω–∞–ª–æ–∂–µ–Ω", recs:[
      "–û—Ç–º–µ—Ç–∏—Ç—å –≤—Ä–µ–º—è –∂–≥—É—Ç–∞. –ö–æ–Ω—Ç—Ä–æ–ª—å –±–æ–ª–∏/–∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è. –ü–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ‚Äî —ç–≤–∞–∫—É–∞—Ü–∏—è –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫."
    ]},
    {id:"q_bleed_controlled", kind:"score", points:3, reason:"–¢—è–∂—ë–ª–æ–µ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º (—Ä–∏—Å–∫ —Å—Ä—ã–≤–∞)", recs:[
      "–ü–æ–≤—Ç–æ—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–≤—è–∑–∫–∏/–∂–≥—É—Ç—ã. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫ –±—ã—Å—Ç—Ä–æ–π —ç–≤–∞–∫—É–∞—Ü–∏–∏."
    ]},
    {id:"q_chest_wound", kind:"score", points:3, reason:"–†–∞–Ω–µ–Ω–∏–µ –≥—Ä—É–¥–∏ (—Ä–∏—Å–∫ —É—Ö—É–¥—à–µ–Ω–∏—è)", recs:[
      "–ö–æ–Ω—Ç—Ä–æ–ª—å –¥—ã—Ö–∞–Ω–∏—è. –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏/—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ."
    ]},
    {id:"q_abd_pelvis_penetrating", kind:"score", points:3, reason:"–ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–Ω–∏–∫–∞—é—â–µ–µ —Ä–∞–Ω–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–∞/—Ç–∞–∑–∞", recs:[
      "–ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏, –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ —à–æ–∫–∞/—É—Ö—É–¥—à–µ–Ω–∏—è."
    ]},
    {id:"q_fracture_major", kind:"score", points:2, reason:"–°–µ—Ä—å—ë–∑–Ω–∞—è —Ç—Ä–∞–≤–º–∞ –∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏", recs:[
      "–ò–º–º–æ–±–∏–ª–∏–∑–∞—Ü–∏—è –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∫–æ–Ω—Ç—Ä–æ–ª—å –±–æ–ª–∏, —ç–≤–∞–∫—É–∞—Ü–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ."
    ]},
    {id:"q_eye_penetrating", kind:"score", points:2, reason:"–ü—Ä–æ–Ω–∏–∫–∞—é—â–∞—è —Ç—Ä–∞–≤–º–∞ –≥–ª–∞–∑–∞", recs:[
      "–ù–µ –¥–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–∑, –∑–∞—â–∏—Ç–∞, —ç–≤–∞–∫—É–∞—Ü–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ."
    ]},
    {id:"q_burn_10_20", kind:"score", points:2, reason:"–û–∂–æ–≥–∏ 10‚Äì20% –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏", recs:[
      "–¢–µ–ø–ª–æ/–∑–∞—â–∏—Ç–∞, –∫–æ–Ω—Ç—Ä–æ–ª—å –±–æ–ª–∏, —ç–≤–∞–∫—É–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏."
    ]},
    {id:"q_infection_redflags", kind:"score", points:2, reason:"–ò–Ω—Ñ–µ–∫—Ü–∏—è/—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å –∫—Ä–∞—Å–Ω—ã–º–∏ —Ñ–ª–∞–≥–∞–º–∏", recs:[
      "–û—Ü–µ–Ω–∏—Ç—å —É—Ö—É–¥—à–µ–Ω–∏–µ/—Å–µ–ø—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—ã—à–µ."
    ]},
    {id:"q_need_iv_support", kind:"score", points:2, reason:"–ù—É–∂–µ–Ω –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å/–ø–æ–¥–¥–µ—Ä–∂–∫–∞", recs:[
      "–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ, –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –∏ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö."
    ]},

    // –ó–ï–õ–Å–ù–û–ï
    {id:"q_stable_minor", kind:"green", points:0, reason:"–°—Ç–∞–±–∏–ª—å–Ω–æ, –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ, –±–µ–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏", recs:[
      "–ù–∞–±–ª—é–¥–µ–Ω–∏–µ, –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø—Ä–∏ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö."
    ]}
  ];

  function catTitle(cat){
    if(cat==="RED") return "üî¥ –≠–í–ê–ö–£–ê–¶–ò–Ø –°–ï–ô–ß–ê–°";
    if(cat==="YEL") return "üü° –≠–í–ê–ö–£–ê–¶–ò–Ø –ü–†–ò –ü–ï–†–í–û–ô –í–û–ó–ú–û–ñ–ù–û–°–¢–ò";
    if(cat==="GRN") return "üü¢ –ú–û–ñ–ù–û –ù–ê–ë–õ–Æ–î–ê–¢–¨ –ù–ê –ú–ï–°–¢–ï";
    return "–ü–æ–∫–∞ –Ω–µ –æ—Ü–µ–Ω–µ–Ω–æ";
  }

  function baseRecs(cat){
    if(cat==="RED"){
      return [
        "1) –ù–µ —Ç—è–Ω—É—Ç—å: –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —ç–≤–∞–∫—É–∞—Ü–∏—é –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ.",
        "2) –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞–∂–¥—ã–µ 3‚Äì5 –º–∏–Ω—É—Ç –¥–æ –ø–µ—Ä–µ–¥–∞—á–∏.",
        "3) –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫—Ä–∞—Ç–∫—É—é –ø–µ—Ä–µ–¥–∞—á—É (—á—Ç–æ, –≥–¥–µ, —á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ, —á—Ç–æ –Ω—É–∂–Ω–æ)."
      ];
    }
    if(cat==="YEL"){
      return [
        "1) –≠–≤–∞–∫—É–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –î–µ—Ä–∂–∞—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —É—Ö—É–¥—à–µ–Ω–∏—é.",
        "2) –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞–∂–¥—ã–µ 10‚Äì15 –º–∏–Ω—É—Ç.",
        "3) –ü–µ—Ä–µ–¥ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ/–¥—ã—Ö–∞–Ω–∏–µ/—Å–æ–∑–Ω–∞–Ω–∏–µ."
      ];
    }
    if(cat==="GRN"){
      return [
        "1) –ù–∞–±–ª—é–¥–µ–Ω–∏–µ –∏ —Å–∞–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø—Ä–∏ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö.",
        "2) –ï—Å–ª–∏ –ø–æ—è–≤—è—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–∏ —É—Ö—É–¥—à–µ–Ω–∏—è ‚Äî –æ—Ç–º–µ—Ç—å –∏—Ö –∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–π –∫–∞—Ç–µ–≥–æ—Ä–∏—é."
      ];
    }
    return [
      "–û—Ç–º–µ—Ç—å –ø—É–Ω–∫—Ç—ã –≤—ã—à–µ ‚Äî –ø–æ—è–≤–∏—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏."
    ];
  }

  function calcCategory(){
    const picked = [];
    let score = 0;
    let hasCritical = false;

    for(const q of QUESTIONS){
      const el = $(q.id);
      if(el && el.checked){
        picked.push(q);
        if(q.kind === "critical") hasCritical = true;
        if(q.kind === "score") score += (q.points || 0);
      }
    }

    let cat = "none";

    if(hasCritical){
      cat = "RED";
    }else{
      if(score >= SCORE_RED) cat = "RED";
      else if(score >= SCORE_YEL) cat = "YEL";
      else{
        if(picked.length === 0) cat = "none";
        else{
          // –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ —Ç–æ–ª—å–∫–æ –∑–µ–ª—ë–Ω–æ–µ
          const onlyGreen = picked.every(x=>x.kind==="green");
          if(onlyGreen) cat = "GRN";
          else cat = "YEL"; // –ø–µ—Ä–µ—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ –ø—Ä–∏ –Ω–µ–ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        }
      }
    }

    const reasons = picked.map(x=>x.reason);

    // —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: –±–∞–∑–æ–≤—ã–µ + –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –ø—É–Ω–∫—Ç–∞–º (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ)
    const recSet = {};
    const recs = [];
    for(const line of baseRecs(cat)){
      if(!recSet[line]){ recSet[line]=1; recs.push(line); }
    }
    for(const q of picked){
      for(const line of (q.recs || [])){
        if(!recSet[line]){ recSet[line]=1; recs.push(line); }
      }
    }

    return {cat, reasons, score, hasCritical, pickedCount: picked.length, recs};
  }

  function buildText(data){
    const dt=(dtEl.value||"").trim();
    const call=(callEl.value||"").trim();
    const brief=(briefEl.value||"").trim();

    const reasonsText = data.reasons.length ? data.reasons.map(r=>"‚Ä¢ "+r).join("\n") : "‚Ä¢ (–Ω–µ —É–∫–∞–∑–∞–Ω—ã)";
    const recText = data.recs.length ? data.recs.map(r=>"‚Ä¢ "+r).join("\n") : "‚Ä¢ (–Ω–µ—Ç)";

    return (
`–≠–í–ê–ö–£–ê–¶–ò–Ø: ${catTitle(data.cat)}
–ë–∞–ª–ª—ã: ${data.score} | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ: ${data.hasCritical ? "–î–ê" : "–ù–ï–¢"}

–î–∞—Ç–∞/–≤—Ä–µ–º—è: ${dt || "-"}
–ü–æ–∑—ã–≤–Ω–æ–π: ${call || "-"}

–ö—Ä–∞—Ç–∫–æ:
${brief || "-"}

–ü—Ä–∏—á–∏–Ω—ã:
${reasonsText}

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
${recText}`
    );
  }

  const resultBox = $("resultBox");
  const resultTitle = $("resultTitle");
  const resultReasons = $("resultReasons");
  const finalText = $("finalText");
  const scorePill = $("scorePill");
  const critPill = $("critPill");
  const pickedPill = $("pickedPill");

  function render(){
    const data = calcCategory();

    scorePill.textContent = "–ë–∞–ª–ª—ã: " + data.score;
    critPill.textContent = "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ: " + (data.hasCritical ? "–î–ê" : "–ù–ï–¢");
    pickedPill.textContent = "–û—Ç–º–µ—á–µ–Ω–æ: " + data.pickedCount;

    resultBox.classList.remove("rRed","rYel","rGrn");
    if(data.cat==="RED") resultBox.classList.add("rRed");
    else if(data.cat==="YEL") resultBox.classList.add("rYel");
    else resultBox.classList.add("rGrn");

    resultTitle.textContent = catTitle(data.cat);

    const reasonsBlock = data.reasons.length ? ("–ü—Ä–∏—á–∏–Ω—ã:\n- " + data.reasons.join("\n- ")) : "–ü—Ä–∏—á–∏–Ω—ã: (–Ω–µ—Ç)";
    const recBlock = data.recs.length ? ("\n\n–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:\n- " + data.recs.join("\n- ")) : "\n\n–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: (–Ω–µ—Ç)";
    resultReasons.textContent = reasonsBlock + "\n\n–ë–∞–ª–ª—ã: " + data.score + (data.hasCritical ? " (–µ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ)" : "") + recBlock;

    finalText.textContent = buildText(data);
  }

  // –ü–æ–¥–ø–∏—Å–∫–∏
  for(const q of QUESTIONS){
    const el = $(q.id);
    if(el) el.addEventListener("change", render);
  }
  dtEl.addEventListener("change", render);
  callEl.addEventListener("input", render);
  briefEl.addEventListener("input", render);

  // COPY
  $("btnCopy").addEventListener("pointerdown", async (e)=>{
    e.preventDefault();
    const v = validateRequired();
    if(!v.ok){ toast("–ó–∞–ø–æ–ª–Ω–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:\n- " + v.missing.join("\n- "), 3200); return; }
    const text = buildText(calcCategory());
    try{
      await navigator.clipboard.writeText(text);
      toast("‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ");
    }catch(_){
      toast("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å. –í—ã–¥–µ–ª–∏ —Ç–µ–∫—Å—Ç –≤—Ä—É—á–Ω—É—é.", 3200);
    }
  });

  // Telegram share
  $("btnTG").addEventListener("pointerdown",(e)=>{
    e.preventDefault();
    const v = validateRequired();
    if(!v.ok){ toast("–ó–∞–ø–æ–ª–Ω–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:\n- " + v.missing.join("\n- "), 3200); return; }

    const text = buildText(calcCategory());

    const tgApp = "tg://msg_url?url=&text=" + encodeURIComponent(text);
    const tgWeb = "https://t.me/share/url?url=&text=" + encodeURIComponent(text);

    // try app
    const a=document.createElement("a");
    a.href=tgApp; a.style.display="none";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);

    // fallback
    setTimeout(()=>{ try{ window.open(tgWeb, "_blank"); }catch(_){ } }, 700);
    toast("–û—Ç–∫—Ä—ã–≤–∞—é Telegram‚Ä¶", 1600);
  });

  // RESET
  $("btnReset").addEventListener("pointerdown",(e)=>{
    e.preventDefault();
    for(const q of QUESTIONS){
      const el = $(q.id);
      if(el) el.checked = false;
    }
    render();
    toast("–°–±—Ä–æ—à–µ–Ω–æ");
  });

  // INIT
  render();
})();
</script>

</body>
  </html>
